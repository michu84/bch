# BCH (Bose–Chaudhuri–Hocquenghem) Codec

Encoder/decoder for a primitive narrow-sense [BCH codes](https://en.wikipedia.org/wiki/BCH_code) over Galois field GF(2) written in standard C++20. 

Instant encoding and decoding with no runtime initialization.

All lookup values including the generator polynomial deduced at compilation time from the known user-provided primitive polynomial and BCH code parameters.

[Berlekamp-Massey algorithm](https://en.wikipedia.org/wiki/Berlekamp%E2%80%93Massey_algorithm) used in decoder for finding the error locator polynomial.

[Chien's search](https://en.wikipedia.org/wiki/Chien_search) used for finding roots of error locator polynomial. For reference, the alternative brute force algorithm can be selected with a compiler option.

Single threaded.

Not optimized.

Header-only implementation.

No 3rd party dependencies.

## Notes

This is an experimental demo project exploring the potential of template metaprogramming and compilation time code execution in the context of error correcting codes.

Operator overloading for polynomial and modulo arithmetic delivers inuitive and self-explanatory code in an otherwise non-trivial cases.

Templated and constexpr polynomial and Galois field implementations allow representing constructs like polynomials with other kinds of polynomials as coefficients in a compact way. A practical example is the error locator polynomial used in decoding.

The resulting top-level encode and decode routines are simple and easy to read.

## Building

The only requirement is a working C++20 compiler.

The range of implemented C++20 features varies among the compilers. If the code doesn't compile, try a different or newer compiler.

Because of my preference this project uses Qt for configuration and building, but no actual Qt references are used in code.

Here's list of configurations it builds for me so far:
- Qt 6.7.2 for GCC 11 on Ubuntu 22.04 Linux 64-bit
- Qt 6.8 beta4 for MinGW 13.1 on Windows 10 64-bit

## Usage

Using the codec requires three things:
- **m** parameter, determines the single codeword length as (2^m)-1
- **t** parameter represents the error correction capability (ECC), affects how many data and parity bits are used within a single codeword size resulting from specifying **m**
- **primitive polynomial** determines the pattern of emergent Galois field (2^m) and is passed in as a variadic sequence of integer powers of its non-zero coefficients

Next, plug the values into the *mr::bch<m, t, prim_poly...>* template to construct a usable type, for example:
    
    #include "bch.h"    
    using bch_type = mr::bch<m, t, prim_poly...>;
    
With the following template parameters:
- m = 7
- t = 13
- primitive polynomial = 1 + x^6 + x^7 (non-zero polynomial coefficient powers: 0, 6, 7)

the resulting codec type is:

    using bch_type = mr::bch<7, 13, 0, 6, 7>;
    
Now it's simple to encode and decode consecutive codewords.

    auto encoded = bch_type::encode_codeword(message_bytes);
    
    //
    // transmission errors may appear here in encoded bits...    
    //
    
    const auto result = bch_type::decode_codeword(*encoded, decoded_bytes);

For more details, please refer to the code in tests.h, tests.cpp and main.cpp.

## main.cpp

Implements an executable application running a single test procedure for m=7, t=13 and primitive polynomial 1 + x^6 + x^7.

This BCH codec configuration results in a codeword of 127 bits with 50 (usable) data bits and 77 (error correcting) parity bits.

Test message is a zero terminated "Hello" text. Using 48 data bits out of 50 available wastes 2 bits in each codeword, but still works good enough for a demo.

Test procedure is running 100 iterations, corrupting the encoded codeword with t random errors in each.

The number of iterations can be controlled by passing a single number as command line argument to the compiled executable.

    ./bch 1000

or

    bch.exe 1000


will execute 1000 iterations instead of 100.

## Example test output
    
With no DEBUG_* compiler flags defined, code in main.cpp prints only one line:

    mr::bch<7, 13, 0, 6, 7> 100 test iterations (encode -> add random errors -> decode) took 7.987698 [s] (avg: 79.876980 [ms])

Adding the DEBUG_VERBOSE_ENC_DEC to the compiler defines makes one line appear for each encode/decode routine execution:

    mr::bch<7, 13, 0, 6, 7>::encode_codeword... execution took 2824 us (0.002824 s)
    mr::bch<7, 13, 0, 6, 7>::decode_codeword... execution took 74724 us (0.074724 s)

The output after adding also the DEBUG_VERBOSE to the compiler defines prints the full debug output for every test iteration, including the full Galois field summary:

    BCH (m=7, n=127, t=ECC=13, data_bits=50, parity_bits=77, primitive_polynomial=11000001)
    Galois field (2^m), m=7, n=2^m-1=127:
    [a^  0]: 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001 % 11000001 = 0000001
    [a^  1]: 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010 % 11000001 = 0000010
    [a^  2]: 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100 % 11000001 = 0000100
    [a^  3]: 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000 % 11000001 = 0001000
    [a^  4]: 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000 % 11000001 = 0010000
    [a^  5]: 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000 % 11000001 = 0100000
    [a^  6]: 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000 % 11000001 = 1000000
    [a^  7]: 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000 % 11000001 = 1000001
    [a^  8]: 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000 % 11000001 = 1000011
    [a^  9]: 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000 % 11000001 = 1000111
    [a^ 10]: 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000 % 11000001 = 1001111
    [a^ 11]: 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000 % 11000001 = 1011111
    [a^ 12]: 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000 % 11000001 = 1111111
    [a^ 13]: 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000 % 11000001 = 0111111
    [a^ 14]: 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000 % 11000001 = 1111110
    [a^ 15]: 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000 % 11000001 = 0111101
    [a^ 16]: 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000 % 11000001 = 1111010
    [a^ 17]: 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000 % 11000001 = 0110101
    [a^ 18]: 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000 % 11000001 = 1101010
    [a^ 19]: 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000 % 11000001 = 0010101
    [a^ 20]: 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000 % 11000001 = 0101010
    [a^ 21]: 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000 % 11000001 = 1010100
    [a^ 22]: 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000 % 11000001 = 1101001
    [a^ 23]: 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000 % 11000001 = 0010011
    [a^ 24]: 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000 % 11000001 = 0100110
    [a^ 25]: 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000 % 11000001 = 1001100
    [a^ 26]: 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000 % 11000001 = 1011001
    [a^ 27]: 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000 % 11000001 = 1110011
    [a^ 28]: 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000 % 11000001 = 0100111
    [a^ 29]: 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000 % 11000001 = 1001110
    [a^ 30]: 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000 % 11000001 = 1011101
    [a^ 31]: 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000 % 11000001 = 1111011
    [a^ 32]: 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000 % 11000001 = 0110111
    [a^ 33]: 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000 % 11000001 = 1101110
    [a^ 34]: 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000 % 11000001 = 0011101
    [a^ 35]: 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000 % 11000001 = 0111010
    [a^ 36]: 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000 % 11000001 = 1110100
    [a^ 37]: 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000 % 11000001 = 0101001
    [a^ 38]: 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000 % 11000001 = 1010010
    [a^ 39]: 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000 % 11000001 = 1100101
    [a^ 40]: 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000 % 11000001 = 0001011
    [a^ 41]: 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000 % 11000001 = 0010110
    [a^ 42]: 00000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000 % 11000001 = 0101100
    [a^ 43]: 00000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000 % 11000001 = 1011000
    [a^ 44]: 00000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000 % 11000001 = 1110001
    [a^ 45]: 00000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000 % 11000001 = 0100011
    [a^ 46]: 00000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000 % 11000001 = 1000110
    [a^ 47]: 00000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000 % 11000001 = 1001101
    [a^ 48]: 00000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000 % 11000001 = 1011011
    [a^ 49]: 00000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000 % 11000001 = 1110111
    [a^ 50]: 00000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000 % 11000001 = 0101111
    [a^ 51]: 00000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000 % 11000001 = 1011110
    [a^ 52]: 00000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000 % 11000001 = 1111101
    [a^ 53]: 00000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000 % 11000001 = 0111011
    [a^ 54]: 00000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000 % 11000001 = 1110110
    [a^ 55]: 00000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000 % 11000001 = 0101101
    [a^ 56]: 00000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000 % 11000001 = 1011010
    [a^ 57]: 00000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000 % 11000001 = 1110101
    [a^ 58]: 00000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000 % 11000001 = 0101011
    [a^ 59]: 00000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000 % 11000001 = 1010110
    [a^ 60]: 00000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000 % 11000001 = 1101101
    [a^ 61]: 00000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000 % 11000001 = 0011011
    [a^ 62]: 00000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000 % 11000001 = 0110110
    [a^ 63]: 00000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 1101100
    [a^ 64]: 00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 0011001
    [a^ 65]: 00000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 0110010
    [a^ 66]: 00000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 1100100
    [a^ 67]: 00000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 0001001
    [a^ 68]: 00000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 0010010
    [a^ 69]: 00000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 0100100
    [a^ 70]: 00000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 1001000
    [a^ 71]: 00000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 1010001
    [a^ 72]: 00000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 1100011
    [a^ 73]: 00000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 0000111
    [a^ 74]: 00000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 0001110
    [a^ 75]: 00000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 0011100
    [a^ 76]: 00000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 0111000
    [a^ 77]: 00000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 1110000
    [a^ 78]: 00000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 0100001
    [a^ 79]: 00000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 1000010
    [a^ 80]: 00000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 1000101
    [a^ 81]: 00000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 1001011
    [a^ 82]: 00000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 1010111
    [a^ 83]: 00000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 1101111
    [a^ 84]: 00000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 0011111
    [a^ 85]: 00000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 0111110
    [a^ 86]: 00000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 1111100
    [a^ 87]: 00000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 0111001
    [a^ 88]: 00000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 1110010
    [a^ 89]: 00000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 0100101
    [a^ 90]: 00000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 1001010
    [a^ 91]: 00000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 1010101
    [a^ 92]: 00000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 1101011
    [a^ 93]: 00000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 0010111
    [a^ 94]: 00000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 0101110
    [a^ 95]: 00000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 1011100
    [a^ 96]: 00000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 1111001
    [a^ 97]: 00000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 0110011
    [a^ 98]: 00000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 1100110
    [a^ 99]: 00000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 0001101
    [a^100]: 00000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 0011010
    [a^101]: 00000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 0110100
    [a^102]: 00000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 1101000
    [a^103]: 00000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 0010001
    [a^104]: 00000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 0100010
    [a^105]: 00000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 1000100
    [a^106]: 00000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 1001001
    [a^107]: 00000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 1010011
    [a^108]: 00000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 1100111
    [a^109]: 00000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 0001111
    [a^110]: 00000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 0011110
    [a^111]: 00000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 0111100
    [a^112]: 00000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 1111000
    [a^113]: 00000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 0110001
    [a^114]: 00000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 1100010
    [a^115]: 00000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 0000101
    [a^116]: 00000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 0001010
    [a^117]: 00000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 0010100
    [a^118]: 00000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 0101000
    [a^119]: 00000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 1010000
    [a^120]: 00000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 1100001
    [a^121]: 00000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 0000011
    [a^122]: 00000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 0000110
    [a^123]: 00001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 0001100
    [a^124]: 00010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 0011000
    [a^125]: 00100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 0110000
    [a^126]: 01000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 1100000
    [a^127]: 10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 % 11000001 = 0000001 (shown for clarity)
    primitive polynomial {msb...lsb}: 11000001
    cyclotomic cosets [a^  1]: 1, 2, 4, 8, 16, 32, 64, 
    cyclotomic cosets [a^  3]: 3, 6, 12, 24, 48, 96, 65, 
    cyclotomic cosets [a^  5]: 5, 10, 20, 40, 80, 33, 66, 
    cyclotomic cosets [a^  7]: 7, 14, 28, 56, 112, 97, 67, 
    cyclotomic cosets [a^  9]: 9, 18, 36, 72, 17, 34, 68, 
    cyclotomic cosets [a^ 11]: 11, 22, 44, 88, 49, 98, 69, 
    cyclotomic cosets [a^ 13]: 13, 26, 52, 104, 81, 35, 70, 
    cyclotomic cosets [a^ 15]: 15, 30, 60, 120, 113, 99, 71, 
    cyclotomic cosets [a^ 19]: 19, 38, 76, 25, 50, 100, 73, 
    cyclotomic cosets [a^ 21]: 21, 42, 84, 41, 82, 37, 74, 
    cyclotomic cosets [a^ 23]: 23, 46, 92, 57, 114, 101, 75, 
    minimal polynomial a^[  1] {msb...lsb}: 11000001
    minimal polynomial a^[  3] {msb...lsb}: 11010101
    minimal polynomial a^[  5] {msb...lsb}: 11110001
    minimal polynomial a^[  7] {msb...lsb}: 10111111
    minimal polynomial a^[  9] {msb...lsb}: 10011101
    minimal polynomial a^[ 11] {msb...lsb}: 10010001
    minimal polynomial a^[ 13] {msb...lsb}: 10100111
    minimal polynomial a^[ 15] {msb...lsb}: 11111101
    minimal polynomial a^[ 19] {msb...lsb}: 11110111
    minimal polynomial a^[ 21] {msb...lsb}: 11010011
    minimal polynomial a^[ 23] {msb...lsb}: 11100101
    generator polynomial (77th order) {msb...lsb}: 111101100111011101100000001110000101111000110101100100001111100011001000100101
    mr::bch<7, 13, 0, 6, 7>::encode_codeword... execution took 2781 us (0.002781 s)
    test poly:      0000000000011011110110110001101100011001010100100000100101110111010111100010100010110110001110001101101010001111111111111111111
    testing by corrupting message bit 81 @ byte 10
    testing by corrupting message bit 35 @ byte 4
    testing by corrupting message bit 70 @ byte 8
    testing by corrupting message bit 22 @ byte 2
    testing by corrupting message bit 36 @ byte 4
    testing by corrupting message bit 126 @ byte 15
    testing by corrupting message bit 85 @ byte 10
    testing by corrupting message bit 71 @ byte 8
    testing by corrupting message bit 83 @ byte 10
    testing by corrupting message bit 79 @ byte 9
    testing by corrupting message bit 111 @ byte 13
    testing by corrupting message bit 95 @ byte 11
    testing by corrupting message bit 33 @ byte 4
    decoding poly:  1000000000011010110110110001101000011001000001110000100011110111010111100010100010110110000011001101101000001111111111111111111
    decoding bit errors...
    syndrome[0]: 0001000 --> a^  3
    syndrome[1]: 0001000 --> a^  6
    syndrome[2]: 1110100 --> a^102
    syndrome[3]: 0001000 --> a^ 12
    syndrome[4]: 1100011 --> a^125
    syndrome[5]: 1110100 --> a^ 77
    syndrome[6]: 1001100 --> a^122
    syndrome[7]: 0001000 --> a^ 24
    syndrome[8]: 1101110 --> a^ 40
    syndrome[9]: 1100011 --> a^123
    syndrome[10]: 1010110 --> a^ 45
    syndrome[11]: 1110100 --> a^ 27
    syndrome[12]: 1010011 --> a^114
    syndrome[13]: 1001100 --> a^117
    syndrome[14]: 1101111 --> a^117
    syndrome[15]: 0001000 --> a^ 48
    syndrome[16]: 1101110 --> a^  5
    syndrome[17]: 1101110 --> a^ 80
    syndrome[18]: 1011111 --> a^ 22
    syndrome[19]: 1100011 --> a^119
    syndrome[20]: 0111001 --> a^ 62
    syndrome[21]: 1010110 --> a^ 90
    syndrome[22]: 0000101 --> a^  9
    syndrome[23]: 1110100 --> a^ 54
    syndrome[24]: 1011111 --> a^ 49
    syndrome[25]: 1010011 --> a^101
    found error locator polynomial root @ a^  1 --> error location: a^126
    found error locator polynomial root @ a^ 16 --> error location: a^111
    found error locator polynomial root @ a^ 32 --> error location: a^ 95
    found error locator polynomial root @ a^ 42 --> error location: a^ 85
    found error locator polynomial root @ a^ 44 --> error location: a^ 83
    found error locator polynomial root @ a^ 46 --> error location: a^ 81
    found error locator polynomial root @ a^ 48 --> error location: a^ 79
    found error locator polynomial root @ a^ 56 --> error location: a^ 71
    found error locator polynomial root @ a^ 57 --> error location: a^ 70
    found error locator polynomial root @ a^ 91 --> error location: a^ 36
    found error locator polynomial root @ a^ 92 --> error location: a^ 35
    found error locator polynomial root @ a^ 94 --> error location: a^ 33
    found error locator polynomial root @ a^105 --> error location: a^ 22
    corrupted (13 errs):    1000000000011010110110110001101000011001000001110000100011110111010111100010100010110110000011001101101000001111111111111111111
    error mask:             1000000000000001000000000000000100000000010101010000000110000000000000000000000000000000001101000000000010000000000000000000000
    corrected:              0000000000011011110110110001101100011001010100100000100101110111010111100010100010110110001110001101101010001111111111111111111
    mr::bch<7, 13, 0, 6, 7>::decode_codeword... execution took 89819 us (0.089819 s)
    mr::bch<7, 13, 0, 6, 7> test result:
    input:      (hex: 48 65 6c 6c 6f 00 00) "Hello"
    encoded:    (hex: ff ff 47 6d 1c 5b 14 af bb 04 a9 8c 8d ed 0d 00)
    corrupted:  (hex: ff ff 07 6d 06 5b 14 af 7b 84 83 0c 8d 6d 0d 40)
    decoded:    (hex: 48 65 6c 6c 6f 00 00) "Hello"

## TODO's

- more code refactoring
- better error reporting
- check compilation on Mac
- add more rigorous tests
- buffered codec input/output
- move codeword layout options from compiler flags to the user code
- automatic primitive polynomial deduction
- even more rigorous automatic tests after primitive polynomial deduction is implemented
- try alternative polynomial implementation
- check the dissassembly
- user-provided generator polynomials

## License

This software may be freely distributed under the MIT License
